<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>AutoTrack - Кузовной ремонт</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Временные стили для админ панели */
        .admin-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #fff;
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
        }

        .admin-screen h1 {
            margin-bottom: 20px;
            color: #2A5CFF;
        }
    </style>
</head>
<body>
<div id="splash">
    <img src="Screen.png" alt="AutoTrack Logo">
</div>

<div id="app">
    <!-- Форма авторизации -->
    <div id="auth-view">
        <div class="auth-card">
            <h2 class="auth-title">Авторизация</h2>
            <div class="auth-form">
                <div class="form-group">
                    <label for="login">Логин</label>
                    <input type="text" id="login" placeholder="Введите логин">
                </div>
                <div class="form-group">
                    <label for="password">Пароль</label>
                    <input type="password" id="password" placeholder="Введите пароль">
                </div>
                <button class="btn btn-auth" id="loginBtn">Войти</button>
            </div>
        </div>
    </div>

    <!-- Основное содержимое приложения (показывается после авторизации) -->
    <div id="main-view" style="display: none;">
        <!-- Здесь ваше оригинальное приложение -->
        <div class="main-content">
            <div class="car-card">
                <div class="carousel" id="carousel">
                    <div class="carousel-inner">
                        <div class="carousel-item">
                            <img src="splash1.jpg" alt="BMW X5 - вид спереди" loading="lazy">
                        </div>
                        <div class="carousel-item">
                            <img src="splash2.jpg" alt="BMW X5 - вид сбоку" loading="lazy">
                        </div>
                    </div>
                </div>

                <div class="car-info">
                    <div class="car-model">BMW X5 (G05)</div>
                    <div class="car-number">А123БВ777</div>
                </div>

                <div class="progress-container">
                    <div class="status-timeline">
                        <div class="timeline-line"></div>
                        <div class="timeline-fill"></div>
                        <div class="timeline-current"></div>

                        <div class="status-item completed">
                            <div class="status-dot">
                                <span class="status-dot-icon">✓</span>
                            </div>
                            <div class="status-content">
                                <div class="status-title">
                                    <span>Дефектовка</span>
                                    <span class="status-date">12.04.2023</span>
                                </div>
                                <div class="status-description">Выявлены все повреждения, составлен отчёт</div>
                            </div>
                        </div>

                        <!-- Остальные элементы статуса -->
                        <!-- ... -->

                    </div>

                    <div class="current-status-card">
                        <div class="current-status-title">
                            <svg class="current-status-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12.5 7H11V13L16.2 16.2L17 14.9L12.5 12.2V7Z" fill="currentColor"/>
                            </svg>
                            Текущий статус
                        </div>
                        <div class="current-status-text">
                            Ваш автомобиль находится в покрасочной камере. Идёт процесс нанесения
                            базового покрытия и лака.
                        </div>
                        <div class="current-status-time">
                            <svg class="time-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M11.99 2C6.47 2 2 6.48 2 12C2 17.52 6.47 22 11.99 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 11.99 2ZM12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4C16.42 4 20 7.58 20 12C20 16.42 16.42 20 12 20ZM12.5 7H11V13L16.25 16.15L17 14.92L12.5 12.25V7Z" fill="currentColor"/>
                            </svg>
                            Ориентировочное завершение: 25.04.2023
                        </div>
                    </div>
                </div>
            </div>

            <div class="buttons-container">
                <button class="btn btn-call" id="callBtn">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20.487 17.14L16.422 13.645C16.2301 13.482 15.9776 13.416 15.7311 13.464C15.4845 13.512 15.2714 13.669 15.148 13.892L13.669 16.557C11.2645 15.438 8.85995 13.033 7.74295 10.628L10.407 9.15095C10.6304 9.0275 10.7876 8.8143 10.8356 8.5676C10.8836 8.3209 10.8177 8.0682 10.654 7.87695L7.15995 3.81295C6.98738 3.61199 6.74052 3.497 6.48145 3.497C6.22238 3.497 5.97552 3.61199 5.80295 3.81295L3.53095 6.37295C3.34385 6.587 3.24582 6.862 3.25695 7.143C3.53795 12.603 11.396 20.461 16.857 20.742C17.138 20.753 17.413 20.655 17.627 20.468L20.187 18.196C20.3873 18.0235 20.5023 17.7766 20.5023 17.5176C20.5023 17.2585 20.3873 17.0116 20.187 16.839L20.487 17.14Z" fill="currentColor"/>
                    </svg>
                    Позвонить в сервис
                </button>
                <button class="btn btn-chat" id="chatBtn">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2ZM20 16H6L4 18V4H20V16Z" fill="currentColor"/>
                    </svg>
                    Написать мастеру
                </button>
            </div>
        </div>

        <!-- История посещений -->
        <div id="history-view">
            <!-- Ваш оригинальный код истории -->
        </div>

        <!-- Детали посещения -->
        <div id="visit-detail-view">
            <!-- Ваш оригинальный код деталей посещения -->
        </div>

        <!-- Профиль пользователя -->
        <div id="profile-view">
            <!-- Ваш оригинальный код профиля -->
        </div>

        <!-- Таббар -->
        <div class="tabbar">
            <!-- Ваш оригинальный код таббара -->
        </div>
    </div>
</div>

<script>
    const tg = window.Telegram?.WebApp || {
        showAlert: (msg) => alert(msg),
        ready: () => {},
        expand: () => {},
        BackButton: { hide: () => {}, show: () => {}, onClick: () => {} }
    };

    // Конфигурация пользователей
    const users = {
        '1': { password: '1', role: 'user' },
        '2': { password: '2', role: 'admin' }
    };

    // Инициализация приложения
    document.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
            document.getElementById('splash').classList.add('hidden');
            initApp();
        }, 1500);
    });

    function initApp() {
        tg.ready();
        tg.expand();

        // Назначаем обработчики событий
        document.getElementById('loginBtn').addEventListener('click', handleLogin);
        document.getElementById('callBtn')?.addEventListener('click', () => {
            if (tg.openTelegramLink) {
                tg.openTelegramLink('tel:+79991234567');
            } else {
                window.open('tel:+79991234567');
            }
        });
        document.getElementById('chatBtn')?.addEventListener('click', () => {
            if (tg.openTelegramLink) {
                tg.openTelegramLink('https://t.me/AutoService_Support');
            } else {
                window.open('https://t.me/AutoService_Support');
            }
        });
    }

    function handleLogin() {
        const login = document.getElementById('login').value.trim();
        const password = document.getElementById('password').value.trim();

        if (!login || !password) {
            tg.showAlert('Введите логин и пароль');
            return;
        }

        if (users[login] && users[login].password === password) {
            document.getElementById('auth-view').style.display = 'none';
            document.getElementById('main-view').style.display = 'block';

            if (users[login].role === 'admin') {
                showAdminScreen();
            }
        } else {
            tg.showAlert('Неверный логин или пароль');
        }
    }

    function showAdminScreen() {
        const adminScreen = document.createElement('div');
        adminScreen.className = 'admin-screen';
        adminScreen.innerHTML = `
            <h1>Административная панель</h1>
            <button class="btn btn-auth" onclick="logout()">Выйти</button>
        `;
        document.getElementById('app').appendChild(adminScreen);
    }

    function logout() {
        document.getElementById('main-view').style.display = 'none';
        document.getElementById('auth-view').style.display = 'flex';
        const adminScreen = document.querySelector('.admin-screen');
        if (adminScreen) adminScreen.remove();
        document.getElementById('login').value = '';
        document.getElementById('password').value = '';
    }

    // Глобальные функции
    window.logout = logout;
    window.showEstimate = () => tg.showAlert('Смета согласована 15.04.2023. Общая сумма: 125 430 руб.');
</script>
</body>
</html>
