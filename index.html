<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>MCSERVICE "Планета Авто" | Кузовной ремонт</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361EE;
            --primary-dark: #3A56D5;
            --primary-light: #E6EAFF;
            --secondary: #3F37C9;
            --accent: #4895EF;
            --danger: #F72585;
            --success: #4CC9F0;
            --warning: #F8961E;
            --light: #F8F9FA;
            --dark: #1A1D21;
            --gray-dark: #495057;
            --gray: #6C757D;
            --gray-light: #ADB5BD;
            --light-gray: #E9ECEF;
            --white: #FFFFFF;
            --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --radius-sm: 12px;
            --radius-md: 16px;
            --radius-lg: 20px;
            --radius-xl: 24px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Splash Screen */
        #splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeOut 0.5s ease 1s forwards;
        }

        .splash-logo {
            width: 120px;
            height: 120px;
            background-color: var(--white);
            border-radius: var(--radius-xl);
            display: flex;
            justify-content: center;
            align-items: center;
            animation: pulse 1.5s ease infinite;
            box-shadow: 0 12px 24px rgba(67, 97, 238, 0.2);
        }

        .splash-logo i {
            font-size: 48px;
            color: var(--primary);
        }

        /* Auth View */
        #auth-view {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--light);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 999;
            opacity: 0;
            transition: opacity 0.5s ease;
            padding: 20px;
        }

        #auth-view.show {
            display: flex;
            opacity: 1;
        }

        .auth-container {
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .auth-header {
            margin-bottom: 2rem;
        }

        .app-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: var(--radius-md);
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 1rem;
            box-shadow: 0 8px 16px rgba(67, 97, 238, 0.15);
        }

        .app-logo i {
            font-size: 32px;
            color: var(--white);
        }

        .auth-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .auth-subtitle {
            color: var(--gray);
            font-size: 1rem;
            line-height: 1.5;
        }

        .auth-form {
            background: var(--white);
            padding: 2rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--card-shadow);
            text-align: left;
        }

        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid var(--light-gray);
            border-radius: var(--radius-sm);
            font-size: 1rem;
            transition: var(--transition);
            background-color: var(--white);
            color: var(--dark);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.1);
        }

        .form-input::placeholder {
            color: var(--gray-light);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 14px 20px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            white-space: nowrap;
            user-select: none;
        }

        .btn-block {
            display: flex;
            width: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: var(--white);
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.2);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(67, 97, 238, 0.25);
        }

        .btn-primary:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(67, 97, 238, 0.2);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--primary);
            border: 1px solid var(--primary-light);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .btn-secondary:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(67, 97, 238, 0.15);
        }

        .btn-secondary:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(67, 97, 238, 0.1);
        }

        .footer-text {
            margin-top: 1.5rem;
            color: var(--gray);
            font-size: 0.875rem;
        }

        /* Main App */
        #app {
            display: none;
            width: 100%;
            min-height: 100vh;
            flex-direction: column;
            background: var(--light);
        }

        #app.show {
            display: flex;
        }

        .app-header {
            background: var(--white);
            padding: 16px 20px;
            padding-top: calc(40px + env(safe-area-inset-top));
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .app-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--dark);
        }

        .main-content {
            flex: 1;
            padding: 20px;
            padding-bottom: 80px;
        }

        /* Cars List */
        .car-card {
            background: var(--white);
            border-radius: var(--radius-md);
            padding: 18px;
            box-shadow: var(--card-shadow);
            margin-bottom: 16px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .car-card:active {
            transform: scale(0.98);
        }

        .car-card h2 {
            font-size: 1.2rem;
            margin-bottom: 12px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .car-card h2 i {
            font-size: 1.1em;
        }

        .car-card p {
            margin-bottom: 8px;
            color: var(--dark);
            font-size: 0.95rem;
        }

        .car-card .car-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--light-gray);
            font-size: 0.9rem;
        }

        .car-card .car-meta span {
            display: flex;
            align-items: center;
            gap: 6px;
            color: var(--gray-dark);
        }

        .car-card .car-meta i {
            color: var(--primary);
            font-size: 0.9em;
        }

        .car-card .car-status {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--primary);
            color: var(--white);
            padding: 4px 10px;
            border-bottom-left-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
        }

        .car-card .car-status.completed {
            background: var(--success);
        }

        .car-card .car-status.warning {
            background: var(--warning);
        }

        /* Car Details */
        .car-details {
            background: var(--white);
            border-radius: var(--radius-md);
            padding: 18px;
            box-shadow: var(--card-shadow);
            margin-bottom: 16px;
        }

        .car-details h2 {
            font-size: 1.3rem;
            margin-bottom: 16px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--light-gray);
        }

        .detail-label {
            font-weight: 500;
            color: var(--gray);
        }

        .detail-value {
            font-weight: 600;
            color: var(--dark);
        }

        .car-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: var(--radius-sm);
            margin-bottom: 16px;
            background-color: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
        }

        .car-image i {
            font-size: 3rem;
        }

        /* Repair Status */
        .repair-status {
            background: var(--white);
            border-radius: var(--radius-md);
            padding: 18px;
            box-shadow: var(--card-shadow);
            margin-bottom: 16px;
        }

        .repair-status h3 {
            font-size: 1.1rem;
            margin-bottom: 16px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-timeline {
            position: relative;
            padding-left: 30px;
        }

        .status-timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--light-gray);
        }

        .status-item {
            position: relative;
            padding-bottom: 20px;
        }

        .status-item:last-child {
            padding-bottom: 0;
        }

        .status-item.active .status-dot {
            background: var(--primary);
            border-color: var(--primary);
        }

        .status-item.completed .status-dot {
            background: var(--success);
            border-color: var(--success);
        }

        .status-dot {
            position: absolute;
            left: -30px;
            top: 3px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: 2px solid var(--gray-light);
            background: var(--white);
            z-index: 1;
        }

        .status-date {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 4px;
        }

        .status-title {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .status-desc {
            font-size: 0.9rem;
            color: var(--gray-dark);
        }

        /* Photo Gallery */
        .photo-gallery {
            background: var(--white);
            border-radius: var(--radius-md);
            padding: 18px;
            box-shadow: var(--card-shadow);
            margin-bottom: 16px;
        }

        .photo-gallery h3 {
            font-size: 1.1rem;
            margin-bottom: 16px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .gallery-container {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            padding-bottom: 10px;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
        }

        .gallery-container::-webkit-scrollbar {
            height: 6px;
        }

        .gallery-container::-webkit-scrollbar-thumb {
            background: var(--primary-light);
            border-radius: 3px;
        }

        .gallery-item {
            flex: 0 0 80%;
            scroll-snap-align: start;
            position: relative;
            border-radius: var(--radius-sm);
            overflow: hidden;
        }

        .gallery-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
            display: block;
        }

        .gallery-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.6);
            color: var(--white);
            padding: 8px;
            font-size: 0.8rem;
        }

        /* Documents */
        .documents-section {
            background: var(--white);
            border-radius: var(--radius-md);
            padding: 18px;
            box-shadow: var(--card-shadow);
            margin-bottom: 16px;
        }

        .documents-section h3 {
            font-size: 1.1rem;
            margin-bottom: 16px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .document-item {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--light-gray);
        }

        .document-item:last-child {
            border-bottom: none;
        }

        .document-icon {
            width: 40px;
            height: 40px;
            background: var(--primary-light);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: var(--primary);
        }

        .document-info {
            flex: 1;
        }

        .document-name {
            font-weight: 600;
            margin-bottom: 2px;
        }

        .document-meta {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .document-actions {
            display: flex;
            gap: 10px;
        }

        .document-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light);
            color: var(--primary);
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }

        .document-btn:hover {
            background: var(--primary-light);
        }

        /* History View */
        .history-list {
            background: var(--white);
            border-radius: var(--radius-md);
            padding: 18px;
            box-shadow: var(--card-shadow);
        }

        .history-list h2 {
            font-size: 1.3rem;
            margin-bottom: 16px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .history-item {
            padding: 14px 0;
            border-bottom: 1px solid var(--light-gray);
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .history-item h3 {
            font-size: 1rem;
            margin-bottom: 6px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .history-item p {
            font-size: 0.9rem;
            color: var(--gray-dark);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .history-item i {
            font-size: 0.9em;
            color: var(--primary);
            min-width: 18px;
        }

        .history-date {
            font-weight: 600;
            color: var(--primary);
        }

        .parts-list {
            margin-top: 8px;
            padding-left: 20px;
        }

        .parts-list ul {
            list-style-type: none;
        }

        .parts-list li {
            font-size: 0.85rem;
            margin-bottom: 4px;
            color: var(--gray-dark);
        }

        /* Profile View */
        .profile-view {
            background: var(--white);
            border-radius: var(--radius-md);
            padding: 18px;
            box-shadow: var(--card-shadow);
        }

        .profile-view h2 {
            font-size: 1.3rem;
            margin-bottom: 16px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .profile-info {
            margin-bottom: 20px;
        }

        .profile-info p {
            margin-bottom: 12px;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .profile-info strong {
            color: var(--dark);
            font-weight: 600;
            min-width: 100px;
            display: inline-block;
        }

        .profile-info i {
            color: var(--primary);
            width: 20px;
            text-align: center;
        }

        .profile-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.show {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: var(--white);
            border-radius: var(--radius-lg);
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal.show .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--gray);
            cursor: pointer;
            padding: 5px;
        }

        /* Games List */
        .games-list {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        .game-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: var(--radius-sm);
            background: var(--light);
            transition: var(--transition);
        }

        .game-item:active {
            transform: scale(0.98);
        }

        .game-icon {
            width: 40px;
            height: 40px;
            background: var(--primary);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: var(--white);
            font-size: 1.2rem;
        }

        .game-info {
            flex: 1;
        }

        .game-name {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 2px;
        }

        .game-desc {
            font-size: 0.8rem;
            color: var(--gray);
        }

        /* Tabbar */
        .tabbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 72px;
            background: var(--white);
            display: flex;
            border-top: 1px solid var(--light-gray);
            padding: 0 20px;
            z-index: 100;
            box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.05);
        }

        .tabbar-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            text-decoration: none;
            font-size: 0.7rem;
            transition: var(--transition);
        }

        .tabbar-item.active {
            color: var(--primary);
        }

        .tabbar-icon {
            font-size: 1.4rem;
            margin-bottom: 4px;
            transition: var(--transition);
        }

        .tabbar-item.active .tabbar-icon {
            transform: translateY(-4px);
        }

        /* Animations */
        @keyframes fadeOut {
            to {
                opacity: 0;
                visibility: hidden;
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* iOS Safe Areas */
        @supports (padding: max(0px)) {
            body {
                padding-left: max(12px, env(safe-area-inset-left));
                padding-right: max(12px, env(safe-area-inset-right));
                padding-bottom: max(12px, env(safe-area-inset-bottom));
            }

            .tabbar {
                padding-bottom: env(safe-area-inset-bottom);
                height: calc(72px + env(safe-area-inset-bottom));
            }

            .main-content {
                padding-bottom: calc(80px + env(safe-area-inset-bottom));
            }
        }

        /* Responsive Adjustments */
        @media (max-width: 480px) {
            .auth-form {
                padding: 1.5rem;
            }

            .car-card, .car-details, .history-list, .profile-view {
                padding: 16px;
            }

            .detail-row {
                flex-direction: column;
                gap: 4px;
            }

            .detail-label {
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
<!-- Splash Screen -->
<div id="splash">
    <div class="splash-logo">
        <i class="fas fa-car-crash"></i>
    </div>
</div>

<!-- Auth Form -->
<div id="auth-view" class="container">
    <div class="auth-container">
        <div class="auth-header">
            <div class="app-logo">
                <i class="fas fa-car-crash"></i>
            </div>
            <h1 class="auth-title">MCSERVICE "Планета Авто"</h1>
            <p class="auth-subtitle">Кузовной ремонт и обслуживание</p>
        </div>

        <form id="login-form" class="auth-form">
            <div class="form-group">
                <label for="username" class="form-label">Логин</label>
                <input type="text" id="username" class="form-input" placeholder="Введите ваш логин" required>
            </div>

            <div class="form-group">
                <label for="password" class="form-label">Пароль</label>
                <input type="password" id="password" class="form-input" placeholder="Введите ваш пароль" required>
            </div>

            <button type="submit" class="btn btn-primary btn-block">
                <i class="fas fa-sign-in-alt"></i> Войти
            </button>
        </form>

        <p class="footer-text">© 2025 MCSERVICE "Планета Авто". Все права защищены.</p>
    </div>
</div>

<!-- Main App -->
<div id="app">
    <div class="app-header">
        <h1 class="app-title" id="current-screen-title">Мои автомобили</h1>
    </div>

    <div class="main-content" id="main-content">
        <!-- Cars List View -->
        <div id="cars-list-view">
            <div class="car-card" data-car-id="1" onclick="App.showCarDetails(1)">
                <div class="car-status">В работе</div>
                <h2><i class="fas fa-car"></i> Volkswagen Tiguan</h2>
                <p>Госномер: А123БВ777</p>
                <p>Год выпуска: 2019</p>
                <div class="car-meta">
                    <span><i class="fas fa-tachometer-alt"></i> 45 230 км</span>
                    <span><i class="fas fa-wrench"></i> Кузовной ремонт</span>
                </div>
            </div>

            <div class="car-card" data-car-id="2" onclick="App.showCarDetails(2)">
                <div class="car-status completed">Готов</div>
                <h2><i class="fas fa-car"></i> Kia Sportage</h2>
                <p>Госномер: Х987УК177</p>
                <p>Год выпуска: 2021</p>
                <div class="car-meta">
                    <span><i class="fas fa-tachometer-alt"></i> 18 750 км</span>
                    <span><i class="fas fa-wrench"></i> Покраска</span>
                </div>
            </div>
        </div>

        <!-- Car Details View (hidden by default) -->
        <div id="car-details-view" style="display: none;">
            <div class="car-details">
                <h2><i class="fas fa-car"></i> <span id="car-model">Volkswagen Tiguan</span></h2>

                <div class="car-image">
                    <i class="fas fa-car"></i>
                </div>

                <div class="detail-row">
                    <span class="detail-label">Госномер:</span>
                    <span class="detail-value" id="car-plate">А123БВ777</span>
                </div>

                <div class="detail-row">
                    <span class="detail-label">VIN:</span>
                    <span class="detail-value" id="car-vin">WVGZZZ5NZJW123456</span>
                </div>

                <div class="detail-row">
                    <span class="detail-label">Год выпуска:</span>
                    <span class="detail-value" id="car-year">2019</span>
                </div>

                <div class="detail-row">
                    <span class="detail-label">Пробег:</span>
                    <span class="detail-value" id="car-mileage">45 230 км</span>
                </div>

                <div class="detail-row">
                    <span class="detail-label">Статус:</span>
                    <span class="detail-value" id="car-status">В работе</span>
                </div>

                <div class="detail-row">
                    <span class="detail-label">Тип работ:</span>
                    <span class="detail-value" id="car-work-type">Кузовной ремонт</span>
                </div>
            </div>

            <!-- Repair Status Timeline -->
            <div class="repair-status" id="repair-status-section">
                <h3><i class="fas fa-tasks"></i> Статус ремонта</h3>
                <div class="status-timeline" id="status-timeline">
                    <!-- Filled dynamically by JavaScript -->
                </div>
            </div>

            <!-- Photo Gallery -->
            <div class="photo-gallery" id="photo-gallery-section">
                <h3><i class="fas fa-camera"></i> Фотоотчет по ремонту</h3>
                <div class="gallery-container" id="gallery-container">
                    <!-- Filled dynamically by JavaScript -->
                </div>
            </div>

            <!-- Documents Section -->
            <div class="documents-section" id="documents-section">
                <h3><i class="fas fa-file-alt"></i> Документы</h3>
                <div class="document-list" id="document-list">
                    <!-- Filled dynamically by JavaScript -->
                </div>
            </div>

            <button class="btn btn-primary btn-block" onclick="App.showServiceHistory()" style="margin-top: 20px;">
                <i class="fas fa-history"></i> История обслуживания
            </button>
        </div>

        <!-- History View (hidden by default) -->
        <div id="history-view" style="display: none;">
            <div class="history-list">
                <h2><i class="fas fa-history"></i> История обслуживания</h2>

                <div class="history-item">
                    <h3><span class="history-date">15.04.2023</span> - Кузовной ремонт</h3>
                    <p><i class="fas fa-car-crash"></i> Устранение повреждений правого борта</p>
                    <p><i class="fas fa-tachometer-alt"></i> Пробег: 45 230 км</p>
                    <p><i class="fas fa-ruble-sign"></i> Стоимость: 87 500 руб.</p>
                    <div class="parts-list">
                        <p><strong>Запчасти:</strong></p>
                        <ul>
                            <li>Крыло правое - 32 500 руб.</li>
                            <li>Покраска - 55 000 руб.</li>
                        </ul>
                    </div>
                </div>

                <div class="history-item">
                    <h3><span class="history-date">10.01.2023</span> - Плановое ТО</h3>
                    <p><i class="fas fa-oil-can"></i> Замена масла и фильтров</p>
                    <p><i class="fas fa-tachometer-alt"></i> Пробег: 42 000 км</p>
                    <p><i class="fas fa-ruble-sign"></i> Стоимость: 12 500 руб.</p>
                </div>
            </div>
        </div>

        <!-- Profile View (hidden by default) -->
        <div id="profile-view" style="display: none;">
            <div class="profile-view">
                <h2><i class="fas fa-user"></i> Мой профиль</h2>

                <div class="profile-info">
                    <p><strong><i class="fas fa-user-tie"></i> Имя:</strong> Иван Петров</p>
                    <p><strong><i class="fas fa-phone"></i> Телефон:</strong> +7 (912) 345-67-89</p>
                    <p><strong><i class="fas fa-envelope"></i> Email:</strong> ivan.petrov@example.com</p>
                    <p><strong><i class="fas fa-car"></i> Автомобилей:</strong> 2</p>
                </div>

                <div class="profile-actions">
                    <button class="btn btn-secondary btn-block" onclick="App.showGames()">
                        <i class="fas fa-gamepad"></i> Игры
                    </button>
                    <button class="btn btn-secondary btn-block" onclick="App.writeToManager()">
                        <i class="fas fa-comment-dots"></i> Написать менеджеру
                    </button>
                    <button class="btn btn-secondary btn-block" onclick="App.callService()">
                        <i class="fas fa-phone-alt"></i> Позвонить в автосервис
                    </button>
                </div>

                <button class="btn btn-primary btn-block" onclick="App.logout()">
                    <i class="fas fa-sign-out-alt"></i> Выйти
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Games Modal -->
<div id="games-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Игры</h3>
            <button class="modal-close" onclick="App.hideGames()">&times;</button>
        </div>
        <div class="games-list">
            <div class="game-item" onclick="App.openGame('2048')">
                <div class="game-icon">
                    <i class="fas fa-th"></i>
                </div>
                <div class="game-info">
                    <div class="game-name">2048</div>
                    <div class="game-desc">Соберите плитку 2048</div>
                </div>
            </div>
            <div class="game-item" onclick="App.openGame('snake')">
                <div class="game-icon">
                    <i class="fas fa-snake"></i>
                </div>
                <div class="game-info">
                    <div class="game-name">Змейка</div>
                    <div class="game-desc">Классическая змейка</div>
                </div>
            </div>
            <div class="game-item" onclick="App.openGame('tetris')">
                <div class="game-icon">
                    <i class="fas fa-shapes"></i>
                </div>
                <div class="game-info">
                    <div class="game-name">Тетрис</div>
                    <div class="game-desc">Собирайте линии</div>
                </div>
            </div>
            <div class="game-item" onclick="App.openGame('minesweeper')">
                <div class="game-icon">
                    <i class="fas fa-bomb"></i>
                </div>
                <div class="game-info">
                    <div class="game-name">Сапер</div>
                    <div class="game-desc">Найдите все мины</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="tabbar">
    <a href="#" class="tabbar-item active" id="main-tab" onclick="App.navigateTo('main')">
        <span class="tabbar-icon"><i class="fas fa-car"></i></span>
        <span>Авто</span>
    </a>
    <a href="#" class="tabbar-item" id="history-tab" onclick="App.navigateTo('history')">
        <span class="tabbar-icon"><i class="fas fa-history"></i></span>
        <span>История</span>
    </a>
    <a href="#" class="tabbar-item" id="profile-tab" onclick="App.navigateTo('profile')">
        <span class="tabbar-icon"><i class="fas fa-user"></i></span>
        <span>Профиль</span>
    </a>
</div>

<script>
    const App = {
        currentView: 'main',
        currentCar: null,

        init() {
            // Show auth form after splash
            setTimeout(() => {
                document.getElementById('splash').style.opacity = '0';
                document.getElementById('auth-view').classList.add('show');

                setTimeout(() => {
                    document.getElementById('splash').style.display = 'none';
                }, 500);

                // Focus on username field
                document.getElementById('username').focus();
            }, 1500);

            // Handle login form
            document.getElementById('login-form').onsubmit = (e) => {
                e.preventDefault();
                this.handleLogin();
            };
        },

        handleLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Simple validation
            if (!username || !password) {
                alert('Введите логин и пароль');
                return;
            }

            // Hide auth form
            document.getElementById('auth-view').style.opacity = '0';

            setTimeout(() => {
                document.getElementById('auth-view').style.display = 'none';
                this.showApp();
            }, 500);
        },

        showApp() {
            document.getElementById('app').classList.add('show');
            this.navigateTo('main');
        },

        navigateTo(view) {
            this.currentView = view;

            // Update active tab
            document.querySelectorAll('.tabbar-item').forEach(item => {
                item.classList.remove('active');
            });
            document.getElementById(`${view}-tab`).classList.add('active');

            // Update title
            const titles = {
                'main': 'Мои автомобили',
                'history': 'История обслуживания',
                'profile': 'Мой профиль'
            };
            document.getElementById('current-screen-title').textContent = titles[view];

            // Show appropriate view
            document.getElementById('cars-list-view').style.display = 'none';
            document.getElementById('car-details-view').style.display = 'none';
            document.getElementById('history-view').style.display = 'none';
            document.getElementById('profile-view').style.display = 'none';

            switch(view) {
                case 'main':
                    document.getElementById('cars-list-view').style.display = 'block';
                    break;
                case 'history':
                    document.getElementById('history-view').style.display = 'block';
                    break;
                case 'profile':
                    document.getElementById('profile-view').style.display = 'block';
                    break;
            }
        },

        showCarDetails(carId) {
            this.currentCar = carId;

            // In a real app, we would fetch car details from API
            const cars = {
                1: {
                    model: 'Volkswagen Tiguan',
                    plate: 'А123БВ777',
                    vin: 'WVGZZZ5NZJW123456',
                    year: '2019',
                    mileage: '45 230 км',
                    status: 'В работе',
                    workType: 'Кузовной ремонт',
                    repairStatus: [
                        {
                            id: 1,
                            date: '10.05.2023',
                            title: 'Приемка автомобиля',
                            description: 'Автомобиль принят на ремонт после ДТП',
                            status: 'completed',
                            photos: [
                                {
                                    url: 'https://example.com/photo1.jpg',
                                    caption: 'Передний вид с повреждениями'
                                },
                                {
                                    url: 'https://example.com/photo2.jpg',
                                    caption: 'Правая сторона с вмятинами'
                                }
                            ]
                        },
                        {
                            id: 2,
                            date: '12.05.2023',
                            title: 'Дефектовка',
                            description: 'Проведена дефектовка кузова, составлена смета',
                            status: 'completed',
                            photos: [
                                {
                                    url: 'https://example.com/photo3.jpg',
                                    caption: 'Дефектовка передней части'
                                }
                            ]
                        },
                        {
                            id: 3,
                            date: '15.05.2023',
                            title: 'Разборка и ремонт кузова',
                            description: 'Демонтированы поврежденные элементы, начат ремонт кузова',
                            status: 'active',
                            photos: [
                                {
                                    url: 'https://example.com/photo4.jpg',
                                    caption: 'Процесс ремонта правого крыла'
                                },
                                {
                                    url: 'https://example.com/photo5.jpg',
                                    caption: 'Подготовка к покраске'
                                }
                            ]
                        },
                        {
                            id: 4,
                            date: '18.05.2023',
                            title: 'Покраска',
                            description: 'Запланирована покраска восстановленных элементов',
                            status: 'pending'
                        },
                        {
                            id: 5,
                            date: '20.05.2023',
                            title: 'Сборка и полировка',
                            description: 'Сборка автомобиля и финальная полировка',
                            status: 'pending'
                        },
                        {
                            id: 6,
                            date: '22.05.2023',
                            title: 'Готов к выдаче',
                            description: 'Автомобиль прошел контроль качества',
                            status: 'pending'
                        }
                    ],
                    documents: [
                        {
                            id: 1,
                            name: 'Смета ремонта',
                            type: 'pdf',
                            date: '12.05.2023',
                            size: '2.4 MB',
                            url: 'https://example.com/estimate.pdf'
                        },
                        {
                            id: 2,
                            name: 'Акт выполненных работ',
                            type: 'pdf',
                            date: '22.05.2023',
                            size: '1.8 MB',
                            url: 'https://example.com/act.pdf'
                        },
                        {
                            id: 3,
                            name: 'Чек об оплате',
                            type: 'pdf',
                            date: '22.05.2023',
                            size: '0.5 MB',
                            url: 'https://example.com/receipt.pdf'
                        }
                    ]
                },
                2: {
                    model: 'Kia Sportage',
                    plate: 'Х987УК177',
                    vin: 'KNDPMCAC5M7123456',
                    year: '2021',
                    mileage: '18 750 км',
                    status: 'Готов',
                    workType: 'Покраска',
                    repairStatus: [
                        {
                            id: 1,
                            date: '01.05.2023',
                            title: 'Приемка автомобиля',
                            description: 'Автомобиль принят на покраску',
                            status: 'completed'
                        },
                        {
                            id: 2,
                            date: '03.05.2023',
                            title: 'Подготовка к покраске',
                            description: 'Поверхности подготовлены к покраске',
                            status: 'completed'
                        },
                        {
                            id: 3,
                            date: '05.05.2023',
                            title: 'Покраска',
                            description: 'Элементы кузова покрашены',
                            status: 'completed'
                        },
                        {
                            id: 4,
                            date: '07.05.2023',
                            title: 'Полировка',
                            description: 'Проведена финальная полировка',
                            status: 'completed'
                        },
                        {
                            id: 5,
                            date: '08.05.2023',
                            title: 'Готов к выдаче',
                            description: 'Автомобиль прошел контроль качества',
                            status: 'completed'
                        }
                    ],
                    documents: [
                        {
                            id: 1,
                            name: 'Смета покраски',
                            type: 'pdf',
                            date: '03.05.2023',
                            size: '1.2 MB',
                            url: 'https://example.com/paint_estimate.pdf'
                        },
                        {
                            id: 2,
                            name: 'Акт выполненных работ',
                            type: 'pdf',
                            date: '08.05.2023',
                            size: '1.5 MB',
                            url: 'https://example.com/paint_act.pdf'
                        }
                    ]
                }
            };

            const car = cars[carId];

            // Update car details
            document.getElementById('car-model').textContent = car.model;
            document.getElementById('car-plate').textContent = car.plate;
            document.getElementById('car-vin').textContent = car.vin;
            document.getElementById('car-year').textContent = car.year;
            document.getElementById('car-mileage').textContent = car.mileage;
            document.getElementById('car-status').textContent = car.status;
            document.getElementById('car-work-type').textContent = car.workType;

            // Update repair status timeline
            this.updateRepairStatus(car.repairStatus);

            // Update photo gallery
            this.updatePhotoGallery(car.repairStatus);

            // Update documents
            this.updateDocuments(car.documents);

            // Show/hide sections based on repair status
            document.getElementById('repair-status-section').style.display = car.status === 'Готов' ? 'none' : 'block';
            document.getElementById('photo-gallery-section').style.display = car.repairStatus.some(s => s.photos && s.photos.length > 0) ? 'block' : 'none';
            document.getElementById('documents-section').style.display = car.documents && car.documents.length > 0 ? 'block' : 'none';

            // Show car details view
            document.getElementById('cars-list-view').style.display = 'none';
            document.getElementById('car-details-view').style.display = 'block';
            document.getElementById('current-screen-title').textContent = car.model;
        },

        updateRepairStatus(statusItems) {
            const timeline = document.getElementById('status-timeline');
            timeline.innerHTML = '';

            statusItems.forEach(item => {
                const statusItem = document.createElement('div');
                statusItem.className = `status-item ${item.status}`;

                statusItem.innerHTML = `
                    <div class="status-dot"></div>
                    <div class="status-date">${item.date}</div>
                    <div class="status-title">${item.title}</div>
                    <div class="status-desc">${item.description}</div>
                `;

                timeline.appendChild(statusItem);
            });
        },

        updatePhotoGallery(repairStatus) {
            const gallery = document.getElementById('gallery-container');
            gallery.innerHTML = '';

            // Collect all photos from all status items
            const allPhotos = [];
            repairStatus.forEach(status => {
                if (status.photos && status.photos.length > 0) {
                    status.photos.forEach(photo => {
                        allPhotos.push({
                            ...photo,
                            statusTitle: status.title
                        });
                    });
                }
            });

            if (allPhotos.length === 0) {
                gallery.innerHTML = '<p style="padding: 16px; text-align: center; color: var(--gray);">Фотографии по ремонту пока отсутствуют</p>';
                return;
            }

            allPhotos.forEach(photo => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';

                galleryItem.innerHTML = `
                    <img src="${photo.url}" alt="Фото ремонта" class="gallery-image" onerror="this.src='data:image/svg+xml;charset=UTF-8,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 300 200\"%3E%3Crect width=\"300\" height=\"200\" fill=\"%23E9ECEF\"/%3E%3Ctext x=\"150\" y=\"100\" font-family=\"Arial\" font-size=\"16\" text-anchor=\"middle\" fill=\"%236C757D\"%3EФото недоступно%3C/text%3E%3C/svg%3E'">
                    <div class="gallery-caption">${photo.statusTitle}: ${photo.caption}</div>
                `;

                gallery.appendChild(galleryItem);
            });
        },

        updateDocuments(documents) {
            const documentList = document.getElementById('document-list');
            documentList.innerHTML = '';

            if (!documents || documents.length === 0) {
                documentList.innerHTML = '<p style="padding: 16px; text-align: center; color: var(--gray);">Документы пока отсутствуют</p>';
                return;
            }

            documents.forEach(doc => {
                const docItem = document.createElement('div');
                docItem.className = 'document-item';

                const icon = this.getDocumentIcon(doc.type);

                docItem.innerHTML = `
                    <div class="document-icon">
                        <i class="${icon}"></i>
                    </div>
                    <div class="document-info">
                        <div class="document-name">${doc.name}</div>
                        <div class="document-meta">${doc.date} · ${doc.size}</div>
                    </div>
                    <div class="document-actions">
                        <button class="document-btn" onclick="App.downloadDocument('${doc.url}', '${doc.name}')">
                            <i class="fas fa-download"></i>
                        </button>
                        <button class="document-btn" onclick="App.shareDocument('${doc.url}', '${doc.name}')">
                            <i class="fas fa-share-alt"></i>
                        </button>
                    </div>
                `;

                documentList.appendChild(docItem);
            });
        },

        getDocumentIcon(type) {
            switch(type) {
                case 'pdf': return 'fas fa-file-pdf';
                case 'doc':
                case 'docx': return 'fas fa-file-word';
                case 'xls':
                case 'xlsx': return 'fas fa-file-excel';
                case 'jpg':
                case 'png':
                case 'gif': return 'fas fa-file-image';
                default: return 'fas fa-file';
            }
        },

        downloadDocument(url, name) {
            alert(`Документ "${name}" будет скачан с URL: ${url}\n\nВ реальном приложении здесь будет реализовано скачивание файла.`);
            // В реальном приложении:
            // const link = document.createElement('a');
            // link.href = url;
            // link.download = name;
            // link.click();
        },

        shareDocument(url, name) {
            if (navigator.share) {
                navigator.share({
                    title: name,
                    text: `Документ из автосервиса: ${name}`,
                    url: url
                }).catch(err => {
                    console.error('Ошибка при попытке поделиться:', err);
                    alert('Не удалось поделиться документом. Скопируйте ссылку вручную.');
                });
            } else {
                alert(`Ссылка на документ "${name}": ${url}\n\nСкопируйте и отправьте вручную.`);
            }
        },

        showServiceHistory() {
            this.navigateTo('history');
        },

        showGames() {
            const modal = document.getElementById('games-modal');
            modal.classList.add('show');
            setTimeout(() => {
                modal.style.opacity = '1';
            }, 10);
        },

        hideGames() {
            const modal = document.getElementById('games-modal');
            modal.style.opacity = '0';
            setTimeout(() => {
                modal.classList.remove('show');
            }, 300);
        },

        openGame(gameName) {
            alert(`Открываем игру: ${gameName}\nЗдесь будет интеграция с @Zer0_Emission_Bot`);
            this.hideGames();
        },

        writeToManager() {
            alert('Открываем чат с менеджером');
        },

        callService() {
            if (confirm('Позвонить в автосервис по номеру +7 (123) 456-78-90?')) {
                window.location.href = 'tel:+71234567890';
            }
        },

        logout() {
            if (confirm('Вы уверены, что хотите выйти?')) {
                document.getElementById('app').classList.remove('show');
                document.getElementById('auth-view').style.display = 'flex';
                document.getElementById('auth-view').style.opacity = '1';

                // Reset form
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                document.getElementById('username').focus();
            }
        }
    };

    // Initialize app when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
        App.init();
    });
</script>
</body>
</html>
