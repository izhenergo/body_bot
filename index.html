<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>AutoTrack - Кузовной ремонт</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;-webkit-tap-highlight-color:transparent}
        body{width:100vw;min-height:100vh;overflow-x:hidden;background:#f5f5f5;color:#333;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}
        #splash{position:fixed;top:0;left:0;right:0;bottom:0;background:#fff;display:flex;justify-content:center;align-items:center;z-index:1000;padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}
        #splash img{width:100%;height:100%;object-fit:contain;padding:20%}
        #splash.hidden{opacity:0;pointer-events:none;transition:opacity .3s ease}
        #app{width:100%;min-height:100vh;display:none;flex-direction:column;padding:16px;padding-top:max(16px,env(safe-area-inset-top));padding-bottom:max(16px,env(safe-area-inset-bottom))}
        #app.visible{display:flex}
        .car-card,.history-card{background:#fff;border-radius:16px;padding:16px;margin-bottom:16px;box-shadow:0 2px 12px rgba(0,0,0,.08);width:100%;max-width:600px;margin:0 auto;position:relative}
        .carousel,.history-carousel{position:relative;width:100%;height:180px;border-radius:12px;overflow:hidden;margin-bottom:12px}
        .carousel-inner,.history-carousel-inner{display:flex;transition:transform .3s ease;height:100%}
        .carousel-item,.history-carousel-item{min-width:100%;height:100%;flex-shrink:0;position:relative}
        .carousel-item img,.history-carousel-item img{width:100%;height:100%;object-fit:cover}
        .history-carousel-caption{position:absolute;bottom:0;left:0;right:0;background:rgba(0,0,0,.6);color:#fff;padding:8px;font-size:12px;text-align:center}
        .car-model,.history-car-model{font-size:18px;font-weight:600;margin-bottom:4px;color:#1a1a1a}
        .car-number,.history-car-number{font-size:14px;color:#666;background:#f7f7f7;padding:4px 8px;border-radius:4px;display:inline-block}
        .history-date{font-size:14px;color:#666;position:absolute;top:16px;right:16px;background:rgba(255,255,255,.9);padding:4px 8px;border-radius:4px}
        .status-timeline{position:relative;padding-left:24px;margin-bottom:24px}
        .timeline-line{position:absolute;left:11px;top:0;bottom:0;width:2px;background:#e0e0e0;z-index:1}
        .timeline-fill{position:absolute;left:11px;top:0;height:62.5%;width:2px;background:#4CAF50;z-index:2;transition:height .5s ease}
        .timeline-current{position:absolute;left:11px;top:62.5%;height:12.5%;width:2px;background:#2A5CFF;z-index:3}
        .status-item{position:relative;padding:8px 0 8px 32px;margin-bottom:12px;z-index:4}
        .status-item:last-child{margin-bottom:0}
        .status-dot{position:absolute;left:0;top:12px;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#fff;border:2px solid #e0e0e0}
        .status-item.completed .status-dot{background:#4CAF50;border-color:#4CAF50;color:#fff}
        .status-item.active .status-dot{background:#2A5CFF;border-color:#2A5CFF;color:#fff}
        .status-dot-icon{font-size:12px;font-weight:700}
        .status-content{background:#f9f9f9;border-radius:8px;padding:12px}
        .status-item.completed .status-content,.status-item.active .status-content{background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.05)}
        .status-title{font-size:14px;font-weight:600;margin-bottom:4px;display:flex;justify-content:space-between}
        .status-item.completed .status-title,.status-item.active .status-title{color:#1a1a1a}
        .status-date{font-size:12px;color:#999}
        .status-item.completed .status-date{color:#4CAF50}
        .status-item.active .status-date{color:#2A5CFF}
        .status-description{font-size:13px;color:#666;line-height:1.4}
        .status-item.active .status-description{color:#333}
        .status-estimate-btn{position:absolute;right:12px;bottom:12px;background:#2A5CFF;color:#fff;border:none;border-radius:6px;padding:4px 8px;font-size:12px;font-weight:500;cursor:pointer}
        .current-status-card{background:#2A5CFF;border-radius:12px;padding:16px;color:#fff;margin-top:16px;box-shadow:0 4px 12px rgba(42,92,255,.2)}
        .current-status-title{font-size:15px;font-weight:600;margin-bottom:8px;display:flex;align-items:center}
        .current-status-icon{margin-right:8px;width:20px;height:20px}
        .current-status-text{font-size:14px;line-height:1.4;margin-bottom:8px}
        .current-status-time{font-size:13px;opacity:.9;display:flex;align-items:center}
        .time-icon{margin-right:6px;width:14px;height:14px}
        .buttons-container{display:flex;flex-direction:column;gap:12px;width:100%;max-width:600px;margin:0 auto;padding-bottom:env(safe-area-inset-bottom)}
        .btn{height:56px;border-radius:16px;border:none;font-size:17px;font-weight:600;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .1s ease,opacity .2s ease;width:100%}
        .btn:active{transform:scale(.96);opacity:.9}
        .btn-call{background:#2A5CFF;color:#fff}
        .btn-chat{background:#EFEFEF;color:#1a1a1a}
        .btn-estimate{background:#2A5CFF;color:#fff;border:none;border-radius:8px;padding:10px 16px;font-size:14px;font-weight:500;cursor:pointer;width:100%}
        .btn-icon{margin-right:8px;width:20px;height:20px}
        .tabbar{position:fixed;bottom:0;left:0;right:0;height:calc(56px + env(safe-area-inset-bottom));background:#fff;display:flex;border-top:1px solid #e0e0e0;z-index:100}
        .tabbar-item{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#666;font-size:12px;text-decoration:none}
        .tabbar-item.active{color:#2A5CFF}
        .tabbar-icon{width:24px;height:24px;margin-bottom:4px}
        .main-content{flex:1;padding-bottom:calc(56px + env(safe-area-inset-bottom));width:100%}
        #history-view{width:100%;padding-bottom:20px;display:none}
        .history-header{padding:16px;margin-bottom:16px}
        .history-header h2{font-size:24px;font-weight:600;color:#1a1a1a}
        .history-items{display:flex;flex-direction:column;gap:20px;padding:0 16px}
        .history-work-list{margin-bottom:16px}
        .history-work-list h3{font-size:16px;font-weight:600;margin-bottom:8px;color:#1a1a1a}
        .history-work-list ul{padding-left:20px}
        .history-work-list li{font-size:14px;color:#333;margin-bottom:4px}
        @supports (-webkit-touch-callout: none){body{min-height:100vh;min-height:-webkit-fill-available}#app{min-height:-webkit-fill-available}}
    </style>
</head>
<body>
<div id="splash"><img src="Screen.png" alt="AutoTrack Logo"></div>

<div id="app">
    <div class="main-content">
        <!-- Основной контент главной страницы -->
        <div class="car-card">
            <!-- ... (остальное содержимое главной страницы без изменений) ... -->
        </div>
    </div>

    <!-- История посещений -->
    <div id="history-view">
        <div class="history-header"><h2>История посещений</h2></div>
        <div class="history-items">
            <div class="history-card">
                <div class="history-date">15.04.2023 - 25.04.2023</div>
                <div class="history-car-info">
                    <div class="history-car-model">BMW X5 (G05)</div>
                    <div class="history-car-number">А123БВ777</div>
                </div>
                <!-- ... (остальное содержимое карточки истории) ... -->
            </div>
            <div class="history-card">
                <div class="history-date">10.02.2023 - 20.02.2023</div>
                <div class="history-car-info">
                    <div class="history-car-model">Audi Q7</div>
                    <div class="history-car-number">В456СЕ777</div>
                </div>
                <!-- ... (остальное содержимое карточки истории) ... -->
            </div>
        </div>
    </div>

    <!-- Tabbar -->
    <div class="tabbar">
        <a href="#" class="tabbar-item active" id="main-tab">
            <svg class="tabbar-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 20V14H14V20H19V12H22L12 3L2 12H5V20H10Z" fill="currentColor"/>
            </svg>
            Главная
        </a>
        <a href="#" class="tabbar-item" id="history-tab">
            <svg class="tabbar-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M19 3H18V1H16V3H8V1H6V3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V8H19V19Z" fill="currentColor"/>
            </svg>
            История
        </a>
        <a href="#" class="tabbar-item">
            <svg class="tabbar-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z" fill="currentColor"/>
            </svg>
            Профиль
        </a>
    </div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    let currentView = 'main', currentSlide = 0, startX = 0, isDragging = false;

    function showMainView() {
        currentView = 'main';
        document.querySelector('.main-content').style.display = 'block';
        document.getElementById('history-view').style.display = 'none';
        document.getElementById('main-tab').classList.add('active');
        document.getElementById('history-tab').classList.remove('active');
        tg.BackButton.hide();
    }

    function showHistoryView() {
        currentView = 'history';
        document.querySelector('.main-content').style.display = 'none';
        document.getElementById('history-view').style.display = 'block';
        document.getElementById('main-tab').classList.remove('active');
        document.getElementById('history-tab').classList.add('active');
        tg.BackButton.show();
        tg.BackButton.onClick(showMainView);
    }

    // ... (остальные функции без изменений) ...

    document.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => {
            document.getElementById('splash').classList.add('hidden');
            document.getElementById('app').classList.add('visible');
            showMainView();
            updateCarousel();
        }, 1500);

        document.getElementById('callBtn')?.addEventListener('click', () => tg.openTelegramLink('tel:+79991234567'));
        document.getElementById('chatBtn')?.addEventListener('click', () => tg.openTelegramLink('https://t.me/AutoService_Support'));
        document.getElementById('history-tab').addEventListener('click', showHistoryView);
        document.getElementById('main-tab').addEventListener('click', showMainView);

        // ... (остальной код инициализации без изменений) ...
    });
</script>
</body>
</html>
